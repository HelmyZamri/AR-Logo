var PremiumMessaging;(function(n){function st(s,h){var a,l;if(ot=t.DefaultLocale,f=h,it=s,nt=f[t.ResourceKey.PriceEnabled],g=f[t.ResourceKey.GoPremiumPrimaryColor],rt=f[t.ResourceKey.GoPremiumActiveColor],document.getElementById(t.IDs.OverlayDiv)){n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Info,"Premium Messaging UI won't be displayed since an overlay is already present.");return}c=i(t.Tags.Div,t.IDs.OverlayDiv);document.body.insertBefore(c,document.body.firstChild);v=i(t.Tags.Div,t.IDs.PremiumMessagingDiv);c.appendChild(v);a=i(t.Tags.Div,t.IDs.PreviousActionButton,t.CssClasses.PremiumMessagingCarouselButton);v.appendChild(a);u=i(t.Tags.Image,"",t.CssClasses.PremiumMessagingCarouselButtonImage);u.setAttribute(t.Attributes.Src,f[t.ResourceKey.CarouselBack]);u.classList.add(t.CssClasses.HiddenElement);u.setAttribute(t.Attributes.AriaRole,t.Attributes.ButtonRole);u.setAttribute(t.Attributes.AriaLabel,t.UIStrings.BackButtonAriaLabel);u.tabIndex=0;a.appendChild(u);o=i(t.Tags.Div,t.IDs.MainContainerDiv);o.tabIndex=0;v.appendChild(o);l=i(t.Tags.Div,t.IDs.NextActionButton,t.CssClasses.PremiumMessagingCarouselButton);v.appendChild(l);e=i(t.Tags.Image,"",t.CssClasses.PremiumMessagingCarouselButtonImage);e.setAttribute(t.Attributes.Src,f[t.ResourceKey.CarouselNext]);e.setAttribute(t.Attributes.AriaRole,t.Attributes.ButtonRole);e.setAttribute(t.Attributes.AriaLabel,t.UIStrings.NextButtonAriaLabel);e.tabIndex=0;r=i(t.Tags.Image,"",t.CssClasses.PremiumMessagingCarouselButtonImage);r.setAttribute(t.Attributes.Src,f[t.ResourceKey.CarouselCheck]);r.classList.add(t.CssClasses.HiddenElement);r.setAttribute(t.Attributes.AriaRole,t.Attributes.ButtonRole);r.setAttribute(t.Attributes.AriaLabel,t.UIStrings.DoneButtonAriaLabel);r.tabIndex=0;l.appendChild(e);l.appendChild(r);ut();tt.Registers.RegisterEvents();o.focus();n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Info,"Office Premium Messaging UI opened")}function ut(){var r=i(t.Tags.Div,t.IDs.TopButtonsDiv),n,u;o.appendChild(r);n=i(t.Tags.Image,"",t.CssClasses.MicrosoftLogo);n.setAttribute(t.Attributes.Src,f[t.ResourceKey.MicrosoftLogo]);n.setAttribute(t.Attributes.AriaLabel,t.UIStrings.MicrosoftLogoLabel);r.appendChild(n);p=i(t.Tags.Div,t.IDs.DismissButton,"","✕");r.appendChild(p);u=i(t.Tags.Div,t.IDs.BottomDiv);k=i(t.Tags.Div,t.IDs.PremiumMessagingCarouselIndicatorContainer);u.appendChild(k);y(t.Page.Start,et());y(t.Page.Page2,w(t.ResourceKey.Page2Image,t.UIStrings.PageTwoTitle,t.UIStrings.PageTwoDescription,t.Page.Page2));y(t.Page.Page3,w(t.ResourceKey.Page3Image,t.UIStrings.PageThreeTitle,t.UIStrings.PageThreeDescription,t.Page.Page3));y(t.Page.Page4,w(t.ResourceKey.Page4Image,t.UIStrings.PageFourTitle,t.UIStrings.PageFourDescription,t.Page.Page4));s=t.Page.Start;h[s][1].children[0].classList.remove(t.CssClasses.HiddenElement);h[s][1].children[1].classList.add(t.CssClasses.HiddenElement);o.appendChild(u)}function y(n,t){var i=ft();k.appendChild(i);h[n]=[t,i];o.appendChild(t)}function ft(){var u=i(t.Tags.Div,"",t.IDs.PremiumMessagingIndicatorContainer),n=i(t.Tags.Image,"",t.CssClasses.PremiumMessagingCarouselIndicator),r;return n.setAttribute(t.Attributes.Src,f[t.ResourceKey.CarouselIndicatorActive]),n.setAttribute(t.Attributes.AriaLabel,t.UIStrings.ActivePageIndicator),n.classList.add(t.CssClasses.HiddenElement),r=i(t.Tags.Image,"",t.CssClasses.PremiumMessagingCarouselIndicator),r.setAttribute(t.Attributes.Src,f[t.ResourceKey.CarouselIndicatorInactive]),r.setAttribute(t.Attributes.AriaLabel,t.UIStrings.InactivePageIndicator),u.appendChild(n),u.appendChild(r),u}function et(){var u=i(t.Tags.Div,"",t.CssClasses.PremiumMessagingPage),s=i(t.Tags.Image,"",t.CssClasses.PremiumMessagingDiamond),e,r,h,n,o;return s.setAttribute(t.Attributes.Src,f[t.ResourceKey.PremiumDiamond]),s.setAttribute(t.Attributes.AriaLabel,t.UIStrings.PremiumDiamondLabel),u.appendChild(s),u.appendChild(i(t.Tags.Div,"",t.CssClasses.PremiumMessagingTitle,t.UIStrings.FirstPageTitle)),e=i(t.Tags.Div,t.CssClasses.PremiumMessagingPanelContainer),r=i(t.Tags.Div,"",t.CssClasses.PremiumMessagingPanel),r.appendChild(i(t.Tags.Div,"",t.CssClasses.PremiumMessagingPanelTitle,t.UIStrings.LeftPanelLineTitle)),r.appendChild(l(t.UIStrings.LeftPanelLineItemOneBoldText,t.UIStrings.LeftPanelLineItemOneText)),r.appendChild(l(t.UIStrings.LeftPanelLineItemTwoBoldText,t.UIStrings.LeftPanelLineItemTwoText)),h=i(t.Tags.Div,"","premiumMessagingPlanTextContainer",""),h.appendChild(i(t.Tags.Div,"",t.CssClasses.PremiumMessagingPlanText,t.UIStrings.LeftPanelDescriptionText)),r.appendChild(h),n=i(t.Tags.Div,"",t.CssClasses.PremiumMessagingPanel),n.appendChild(i(t.Tags.Div,"",t.CssClasses.PremiumMessagingPanelTitle,t.UIStrings.RightPanelTitle)),nt?n.appendChild(l(t.UIStrings.RightPanelLineItemOneBoldTextPriceFlight,t.UIStrings.RightPanelLineItemOneTextPriceFlight)):n.appendChild(l(t.UIStrings.RightPanelLineItemOneBoldText,t.UIStrings.RightPanelLineItemOneText)),n.appendChild(l(t.UIStrings.RightPanelLineItemTwoBoldText,t.UIStrings.RightPanelLineItemTwoText)),n.appendChild(l(t.UIStrings.RightPanelLineItemThreeBoldText,t.UIStrings.RightPanelLineItemThreeText)),nt?(o=i(t.Tags.Div,"","premiumMessagingPlanTextContainer",""),o.appendChild(b(t.Page.Start,"12px")),o.appendChild(i(t.Tags.Div,"",t.CssClasses.PremiumMessagingPlanText,t.UIStrings.SubscriptionCost)),n.appendChild(o)):n.appendChild(b(t.Page.Start)),e.appendChild(r),e.appendChild(n),u.appendChild(e),u}function l(n,r){var u=i(t.Tags.Div,"",t.CssClasses.PremiumMessagingLineItem);return u.appendChild(i(t.Tags.Span,"",t.CssClasses.PremiumMessagingTextHeavy,n)),u.appendChild(i(t.Tags.Span,"",t.CssClasses.PremiumMessagingPanelText," "+r)),u}function w(n,r,u,e){var o=i(t.Tags.Div,"",t.CssClasses.PremiumMessagingPage),s=i(t.Tags.Image,""),h,c;return s.setAttribute(t.Attributes.Src,f[n]),s.setAttribute(t.Attributes.AriaLabel,r),o.appendChild(s),o.appendChild(i(t.Tags.Div,"",t.CssClasses.PremiumMessagingTitle,r)),h=i(t.Tags.Div,"",t.CssClasses.PremiumMessagingTextPage),h.appendChild(i(t.Tags.Div,"",t.CssClasses.PremiumMessagingText,u)),o.appendChild(h),c=i(t.Tags.Div,"",t.CssClasses.PremiumMessagingGoPremiumButtonContainer),c.appendChild(b(e)),o.appendChild(c),o.classList.add(t.CssClasses.HiddenElement),o}function b(n,r){var u=i(t.Tags.Button,"",t.CssClasses.PremiumMessagingGoPremiumButton,t.UIStrings.GoPremiumButtonText);return u.style.background=g,r&&(u.style.marginBottom=r),u.tabIndex=0,u.onmouseover=function(){u.style.background=rt},u.onmouseout=function(){u.style.background=g},d[n]=u,u}function i(n,i,r,u){if(r===void 0&&(r=""),u===void 0&&(u=""),!n)return null;var f=document.createElement(n);return i&&f.setAttribute(t.Attributes.Id,i),r&&f.setAttribute(t.Attributes.Class,r),u&&(f.innerText=u),f}function ht(n,r,u,f){r===void 0&&(r="");u===void 0&&(u="");f===void 0&&(f="");var e=i(t.Tags.Link,n,r,u);return f&&e.setAttribute(t.Attributes.HRef,f),e}var t,a,tt;(function(n){var t,i,r,u,f,e,o,s,h;(function(n){n.Button="button";n.Div="div";n.Iframe="iframe";n.Image="img";n.Span="span";n.Link="a"})(t=n.Tags||(n.Tags={})),function(n){n.AriaLabel="aria-label";n.AriaRole="role";n.ButtonRole="button";n.Class="class";n.Id="id";n.Src="src";n.OnClick="onclick";n.HRef="href";n.Alt="alt"}(i=n.Attributes||(n.Attributes={})),function(n){n.BottomDiv="premiumMessagingBottomDiv";n.DismissButton="premiumMessagingDismissButton";n.GotItButton="premiumMessagingGotItButton";n.LandingPageUpperMessageDiv="premiumMessagingLandingPageUpperMessageDiv";n.MainContainerDiv="premiumMessagingMainContainerDiv";n.NextActionButton="premiumMessagingNextActionButton";n.OverlayDiv="inProductMessagingOverlayDiv";n.PremiumMessagingCarouselIndicatorContainer="premiumMessagingCarouselIndicatorContainer";n.PremiumMessagingDiv="premiumMessagingDiv";n.PremiumMessagingIndicatorContainer="premiumMessagingIndicatorContainer";n.PreviousActionButton="premiumMessagingPreviousActionButton";n.RemindMeLaterButton="premiumMessagingRemindMeLaterButton";n.TopButtonsDiv="premiumMessagingTopButtonsDiv"}(r=n.IDs||(n.IDs={})),function(n){n.HiddenElement="hiddenElement";n.MicrosoftLogo="mslogo";n.PremiumMessagingGoPremiumButtonContainer="premiumMessagingGoPremiumButtonContainer";n.PremiumMessagingCarouselButton="premiumMessagingCarouselButton";n.PremiumMessagingCarouselButtonImage="premiumMessagingCarouselButtonImage";n.PremiumMessagingCarouselIndicator="premiumMessagingCarouselIndicator";n.PremiumMessagingDiamond="premiumMessagingDiamond";n.PremiumMessagingGoPremiumButton="premiumMessagingGoPremiumButton";n.PremiumMessagingLineItem="premiumMessagingLineItem";n.PremiumMessagingPage="premiumMessagingPage";n.PremiumMessagingPanel="premiumMessagingPanel";n.PremiumMessagingPanelText="premiumMessagingPanelText";n.PremiumMessagingPanelTitle="premiumMessagingPanelTitle";n.PremiumMessagingPanelContainer="premiumMessagingPanelContainer";n.PremiumMessagingPlanText="premiumMessagingPlanText";n.PremiumMessagingText="premiumMessagingText";n.PremiumMessagingTextHeavy="premiumMessagingTextHeavy";n.PremiumMessagingTextPage="premiumMessagingTextPage";n.PremiumMessagingTitle="premiumMessagingTitle"}(u=n.CssClasses||(n.CssClasses={})),function(n){n.CarouselBack="CarouselBack";n.CarouselCheck="CarouselCheck";n.CarouselIndicatorActive="CarouselIndicatorActive";n.CarouselIndicatorInactive="CarouselIndicatorInactive";n.CarouselNext="CarouselNext";n.GoPremiumLink="GoPremiumLink";n.GoPremiumActiveColor="GoPremiumActiveColor";n.GoPremiumPrimaryColor="GoPremiumPrimaryColor";n.MainDivLogo="MainDivLogo";n.MicrosoftLogo="MicrosoftLogo";n.Page2Image="Page2Image";n.Page3Image="Page3Image";n.Page4Image="Page4Image";n.PremiumDiamond="PremiumDiamond";n.PriceEnabled="PriceEnabled"}(f=n.ResourceKey||(n.ResourceKey={})),function(n){n.FirstPageTitle="Go premium with Office 365";n.GoPremiumButtonText="Go premium";n.LeftPanelLineItemOneBoldText="5GB";n.LeftPanelLineItemOneText="of OneDrive cloud storage";n.LeftPanelLineItemTwoBoldText="Office";n.LeftPanelLineItemTwoText="basic apps";n.LeftPanelLineTitle="Office";n.LeftPanelDescriptionText="Your current plan";n.PageTwoTitle="Access your world, anywhere";n.PageTwoDescription="With 1 TB of OneDrive cloud storage per person, you can securely save, edit, and share your files from all your devices, anywhere.​";n.PageThreeTitle="Protect what's important";n.PageThreeDescription="With commercial-grade digital protection, automatic back-up, and file restore, your personal files and photos will be kept safe and secure.​";n.PageFourTitle="Create your best work";n.PageFourDescription="Premium AI-powered tools figure out what you’re trying to do, and help you get there faster – whether it’s a well-crafted resume, personal finance tracker, or photo slide show.​";n.RightPanelLineItemOneBoldText="1000+ GB (1 TB)";n.RightPanelLineItemOneText="of OneDrive cloud storage per user, for up to 6 users";n.RightPanelLineItemOneBoldTextPriceFlight="1000+ GB (1 TB)";n.RightPanelLineItemOneTextPriceFlight="OneDrive storage";n.RightPanelLineItemTwoBoldText="Office installation";n.RightPanelLineItemTwoText="for PC + Mac";n.RightPanelLineItemThreeBoldText="Premium security";n.RightPanelLineItemThreeText="& design tools";n.RightPanelTitle="Office 365";n.NextButtonAriaLabel="Next";n.DoneButtonAriaLabel="Done";n.BackButtonAriaLabel="Back";n.MicrosoftLogoLabel="Microsoft logo";n.PremiumDiamondLabel="Premium";n.ActivePageIndicator="Active page";n.InactivePageIndicator="Inactive page";n.SubscriptionCost="$69.99/year"}(e=n.UIStrings||(n.UIStrings={})),function(n){n.Enter=13;n.Esc=27;n.LeftArrow=37;n.RightArrow=39;n.Space=32}(o=n.Keys||(n.Keys={})),function(n){n[n.Start=0]="Start";n[n.Page2=1]="Page2";n[n.Page3=2]="Page3";n[n.Page4=3]="Page4"}(s=n.Page||(n.Page={})),function(n){n[n.Back=-1]="Back";n[n.Next=1]="Next"}(h=n.PageDirection||(n.PageDirection={}));n.DefaultLocale="en-us"})(t=n.Constants||(n.Constants={})),function(n){function i(n){n!=null&&n.parentNode!=null&&n.parentNode.removeChild(n)}function r(n){return n===t.Keys.Enter||n===t.Keys.Space?!0:!1}n.Remove=i;n.IsKeyEnterOrSpace=r}(a=n.Utils||(n.Utils={})),function(i){var v,l,y;(function(i){function c(t){n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Info,"User clicked on the background area. Premium Messaging UI will be dismissed.");l.DismissOverlay(t,!1)}function v(i){switch(i.type){case"keyup":i.preventDefault();i.stopImmediatePropagation();i.keyCode===t.Keys.Esc?(n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Info,"User pressed the Escape key. Premium Messaging UI will be dismissed."),l.DismissOverlay(i,!1)):i.keyCode===t.Keys.RightArrow?f(t.PageDirection.Next,i):i.keyCode===t.Keys.LeftArrow&&f(t.PageDirection.Back,i);break;default:n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Error,"Event can't be recognized")}}function y(i){i.type=="click"||i.type=="keydown"&&a.IsKeyEnterOrSpace(i.keyCode)?(n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Info,"User pressed Next Action button"),l.StopEventPropagation(i),f(t.PageDirection.Next,i)):n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Info,"Unknown Next Action")}function p(i){i.type=="click"||i.type=="keydown"&&a.IsKeyEnterOrSpace(i.keyCode)?(n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Info,"User pressed Previous Action button"),l.StopEventPropagation(i),f(t.PageDirection.Back,i)):n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Info,"Unknown Previous Action")}function f(i,f){var h=s+i;if(!(h<0)){if(h>t.Page.Page4){n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Info,"User clicked check mark to dismiss");l.DismissOverlay(f,!1);return}h==t.Page.Start?u.classList.add(t.CssClasses.HiddenElement):s==t.Page.Start&&i==t.PageDirection.Next&&u.classList.remove(t.CssClasses.HiddenElement);h==t.Page.Page4?(r.classList.remove(t.CssClasses.HiddenElement),e.classList.add(t.CssClasses.HiddenElement)):s==t.Page.Page4&&i==t.PageDirection.Back&&(r.classList.add(t.CssClasses.HiddenElement),e.classList.remove(t.CssClasses.HiddenElement));o(h)}}function o(n){h[s][0].classList.add(t.CssClasses.HiddenElement);h[s][1].children[0].classList.add(t.CssClasses.HiddenElement);h[s][1].children[1].classList.remove(t.CssClasses.HiddenElement);h[n][0].classList.remove(t.CssClasses.HiddenElement);h[n][1].children[0].classList.remove(t.CssClasses.HiddenElement);h[n][1].children[1].classList.add(t.CssClasses.HiddenElement);s=n;h[n][0].focus()}function w(t){n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Info,"User clicked on 'Go premium' button on page: "+s);(t.type=="click"||t.type=="keydown"&&a.IsKeyEnterOrSpace(t.keyCode))&&(l.DismissOverlay(t,!0),l.OpenOfficeDotCom())}function b(t){n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Info,"User clicked on 'Dismiss' button. Premium Messaging UI will be dismissed.");l.DismissOverlay(t,!1)}i.OverlayEventHandler=c;i.WindowEventHandler=v;i.NextActionEventHandler=y;i.PreviousActionEventHandler=p;i.ChangePageAction=f;i.SetPage=o;i.GoPremiumEventHandler=w;i.DismissEventHandler=b})(v=i.Handlers||(i.Handlers={})),function(n){function i(n,t,i){n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent&&n.attachEvent("on"+t,i)}function r(n,t,i){n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent&&n.detachEvent("on"+t,i)}function u(n){n.stopPropagation()}function e(n,t){n.stopPropagation();a.Remove(c);y.UnregisterEvents();it(t)}function o(){window.open(f[t.ResourceKey.GoPremiumLink],"_blank")}n.addEventListenerHelper=i;n.removeEventListenerHelper=r;n.StopEventPropagation=u;n.DismissOverlay=e;n.OpenOfficeDotCom=o}(l=i.Helpers||(i.Helpers={})),function(n){function t(){l.addEventListenerHelper(c,"click",v.OverlayEventHandler);l.addEventListenerHelper(c,"touchend",v.OverlayEventHandler);l.addEventListenerHelper(window,"keyup",v.WindowEventHandler);l.addEventListenerHelper(o,"click",l.StopEventPropagation);l.addEventListenerHelper(o,"touchend",l.StopEventPropagation);l.addEventListenerHelper(p,"click",v.DismissEventHandler);d.forEach(function(n){n&&(l.addEventListenerHelper(n,"click",v.GoPremiumEventHandler),l.addEventListenerHelper(n,"keydown",v.GoPremiumEventHandler))});l.addEventListenerHelper(e,"click",v.NextActionEventHandler);l.addEventListenerHelper(e,"keydown",v.NextActionEventHandler);l.addEventListenerHelper(r,"click",v.NextActionEventHandler);l.addEventListenerHelper(r,"keydown",v.NextActionEventHandler);l.addEventListenerHelper(u,"click",v.PreviousActionEventHandler);l.addEventListenerHelper(u,"keydown",v.PreviousActionEventHandler)}function i(){l.removeEventListenerHelper(c,"click",v.OverlayEventHandler);l.removeEventListenerHelper(c,"touchend",v.OverlayEventHandler);l.removeEventListenerHelper(window,"keyup",v.WindowEventHandler);l.removeEventListenerHelper(o,"click",l.StopEventPropagation);l.removeEventListenerHelper(o,"touchend",l.StopEventPropagation);l.removeEventListenerHelper(p,"click",v.DismissEventHandler);d.forEach(function(n){n&&(l.removeEventListenerHelper(n,"click",v.GoPremiumEventHandler),l.removeEventListenerHelper(n,"keydown",v.GoPremiumEventHandler))});l.removeEventListenerHelper(e,"click",v.NextActionEventHandler);l.removeEventListenerHelper(e,"keydown",v.NextActionEventHandler);l.removeEventListenerHelper(r,"click",v.NextActionEventHandler);l.removeEventListenerHelper(r,"keydown",v.NextActionEventHandler);l.removeEventListenerHelper(u,"click",v.PreviousActionEventHandler);l.removeEventListenerHelper(u,"keydown",v.PreviousActionEventHandler)}n.RegisterEvents=t;n.UnregisterEvents=i}(y=i.Registers||(i.Registers={}))}(tt=n.Events||(n.Events={}));var it,c,v,p,o,e,r,u,k,f,h=new Array(4),d=new Array(4),s=t.Page.Start,ot,g,rt,nt=!1;n.InitFreemiumDialog=st;n.CreateMessagingPages=ut;n.AddPage=y;n.CreateCarouselIndicator=ft;n.CreateFirstPage=et;n.CreateHalfBoldedLineItem=l;n.CreateUpsellPage=w;n.CreateGoPremiumButton=b;n.CreateDomElement=i;n.CreateDomLink=ht})(PremiumMessaging||(PremiumMessaging={})),function(n){var t;(function(n){var t;(function(n){n[n.Error=0]="Error";n[n.Warning=1]="Warning";n[n.Info=2]="Info";n[n.Verbose=3]="Verbose";n[n.Spam=4]="Spam"})(t=n.LogLevel||(n.LogLevel={}));n.NetworkingMgr=null})(t=n.Networking||(n.Networking={}))}(PremiumMessaging||(PremiumMessaging={}));
//# sourceMappingURL=PremiumMessaging.js.map
